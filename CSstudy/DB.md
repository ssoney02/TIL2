# 1. 데이터베이스의 큰 그림

## 데이터베이스와 DBMS

- 데이터베이스: 여러 사람이 공유하여 사용할 목적으로 체계화 해 통합, 관리하는 데이터의 집합
    - 원하는 기능을 동작시키기 위해 마땅히 저장해야 하는 정보의 집합
- 데이터베이스 관리 시스템(DBMS) : 데이터베이스를 관리하기 위한 프로그램

### DBMS의 종류

1. 관계형 데이터베이스 관리 시스템(RDBMS, 관계형 데이터 베이스)
    - MySQL, Oracle, .. SQLite, MariaDB, ,,
2. NoSQL 데이터베이스 관리 시스템(NoSQL DBMS)
    - MongoDB, Redis

### 서버로서의 DBMS

- DBMS: 사용자와 직접적으로 상호작용하기보다는 사용자(개발자)가 만든 프로그램과 상호작용하며 실행
    
    ➕ 다른컴퓨터의 응용프로그램에서도 DBMS에 접속 가능
    
- 응용 프로그램이 DBMS를 이용하는 과정
    - 쓰리웨이 핸드셰이크를 통한 TCP 연결,
    - DBMS 클라이언트 → DBMS에 쿼리 보냄
    
    → 이를 위해 DBMS가 데이터베이스르르 다루기 위한 언어 제공
    
    - SQL : RDBMS에서 데이터를 조작하고 관리하기 위한 언어
        - 데이터베이스에 질의(쿼리) 하기 위한 구조화된 언어
        - SQL 종류
            1. DDL(Data Definition Language) : 데이터 정의
            2. DML(Data Manipulation Language): 데이터 조작
            3. DCL(Data Control Language): 데이터 제어
            4. TCL(Transaction Control Language): 트랜잭션 제어
    

### 파일 대신 DB 사용하는 이유(파일의 단점)

1. 데이터 일관성 및 무결성 제공이 어려움
    - 레이스 컨디션 문제 발생 여지 o → 데이터 일관성 훼손되기 쉬움
    
    ⇒ 데이터 무결성 보장 어려움
    
2. 불필요한 중복 저장 증가
3. 데이터 변경 시 연관 데이터 변경 어려움
4. 정교한 검색 어려움
5. 백업 및 복구 어려움 → DB에서는 백업, 복구 기능 제공

### 데이터베이스의 저장 단위와 트랜잭션

- 데이터베이스의 저장 단위
    
    → DB에는 다양한 속성으 가진 독립적 객체들이 저장될 수 o
    
    - 엔티티: 독립적으로 존재할 수 있는 객체
        - ‘어떠한 특성을 가진 대상’
    - 속성: 엔티티의 특성
    - 엔티티집합 ← 같은 속성을 공유하는 개별 엔티티는 엔티티 집합에 속함
    - 도메인: 엔티티의 속성이 가질 수 있는 값의 집합
        - ex. ‘구매자 성별’ 속성이 가질 수 있는 도메인 ⇒ (남자,여자)
    
    ---
    
    ➕
    
    - **릴레이션**: RDBMS에서 표현되는 이차원 테이블 형태의 엔티티 집합
    - **컬렉션**: NoSQL DBMS의 일종인 MongoDB에서의 엔티티 집합 단위
    
    ---
    
    - **레코드**: 데이터베이스에 저장된 대상
        - 데이터베이스에 기록된 각각의 엔티티
    - **필드**: 데이터베이스에 저장된 엔티티 속성
    
    ---
    
    - RDBMS → 개별 레코드 : **행** / 필드: **열**
    - MongoDB - NoSQL
        
        → 개별 레코드 : Json 형태 데이터 **‘도큐먼트’** 단위로 표현
        
        → 필드: Json의 **키** 형태로 표현
        
    - 필드 수 → ‘**차수**’라고도 부름
        - **카디날리티**: 한 필드에 대한 고유 값의 수
            
            ⇒ 카디날리티가 낮을수록 중복된 속성이 많음
            
- 스키마
    
    : 데이터베이스에 저장되는 레코드의 구조와 제약조건을 정의한 것
    
    - RDBMS와 NoSQL을 구분하는 주요 기준 중 하나 ⇒ 스키마의 유무
        - NoSQL → 명확한 스키마가 정의되지 x
            
            (스키마-리스 데이터베이스 라고도 부름)
            
            →유연한 형태로 레코드 관리 가능 (고정된 스키마를 따르지 않으므로!)
            
        - RDBMS: 정형화된 데이터만 저장 가능!
- 트랜잭션과 ACID
    - **트랜잭션**: 데이터베이스와의 논리적 상호작용의 단위
    - **초당 트랜잭션(TPS, Transactions Per Second)** 이라는 지표로 데이터베이스와 작업 성능 나타내기도 함
        
        ⚠️ 트랜잭션이 하나의 쿼리만 포함하는 것은 x
        
    - 데이터베이스 → 여러 사용자/프로그램이 동시다발적으로 사용하는 것이 일반적
        - 트랜잭션이 동시다발적으로 실행될 때 → 안전한 트랜잭션 보장을 위해 지켜야할 성질 o
    - 트랜잭션이 지켜야 하는 성질
        1. 원자성
            
            : 하나의 트랜잭션 결과가 모두 성공하거나 모두 실패하는 성질
            
            (트랜잭션이 하나의 단위로 처리됨)
            
            ➕ 커밋과 롤백
            
            - 원자성: 트랜잭션이 반드시 커밋되거나 롤백되는 성질
            - 커밋: 트랜잭션을 성공적으로 수행하여 트랜잭션을 종료하는 것
            - 롤백: 이전 트랜잭션을 취소하는 작업
                
                → 트랜잭션이 이루어지기 전으로 되돌릴 수 o
                
        2. 일관성
            
            : 트랜잭션 전후로 DB가 일관된 상태를 유지하는 성질
            
            - ‘일관된 상태’ : 데이터베이스가 지켜야하는 일련의 규칙들을 지키는 상태
            - 새로운 일관된 상태로 전이될 수는 o (그래도, 저장된 데이터들은 일관된 상태를 유지하긴 함)
        3. 격리성
            
            : 동시에 수행되는 여러 트랜잭션이 서로 간섭하지 않도록 보장하는 성질
            
            → 레이스 컨디션을 방지하기 위한 성질
            
            한 트랜잭션이 어떤 데이터에 접근하여 조작 중일 때 다른 트랜잭션이 접근 불가
            
        4. 지속성
            
            : 트랜잭션이 성공적으로 완료된 후에 그 결과가 영구적으로 반영되는 성질
            
            → 시스템 장애가 발생하더라도 완료된 트랜잭션의 결과는 손실되지 않아야됨
            
            ⇒ 회복 메커니즘 (지속성 보장을 위해 구현되어있음)
            

# 2. RDBMS의 기본

- 관계형 데이터베이스 → 1. 테이블 구성 2. 관계

## 테이블의 구성: 필드와 레코드

- 필드 타입: 각 필드로 사용 가능한 데이터 유형
    
    ![image.png](attachment:ca81ea53-169a-460c-90b8-57a2a8f001b4:image.png)
    
- 키: 테이블 내의 특정 레코드를 식별할 수 있는 필드의 집합
    - 용도
        1. 레코드의 식별
        2. 테이블 간의 참조
        3. 테이블의 접근 속도 높이기 위해
    - 키의 종류
        1. **후보 키**: 테이블의 한 레코드를 식별하기 위한 필드의 최소 집합
            - ‘유일성을 갖춤’ : 특정 레코드를 유일하게 식별
            
            → 하나 이상의 필드로 구성 가능 / 후보 키에 포함된 필드 중 하나라도 생략하면 레코드 고유 식별 x
            
            - ‘최소성을 갖춤’ : 최소한의 정보로 레코드를 식별 (불필요한 필드가 키에 포함되어있지x)
            
            ⇒ 유일성, 최소성 모두 만족하는 키
            
        2. **복합 키**: 두 필드 이상으로 구성된 후보 키
            
            cf. 슈퍼 키: 레코드를 식별하기 위한 필드의 집합 (최소 집합 xxxxx)
            
            - 유일성 만족 o  / 최소성 만족 x
        3. **기본 키(PK)**: 한 레코드를 식별하도록 선정되어 테이블 당 하나만 존재할 수 있는 키
            
            → 여러 후보 키 중에서 테이블의 레코드를 대표하도록 선택된 키 
            
            → 후보 키의 일부! → 유일성, 최소성 모두 만족
            
            여러 필드로 구성된 기본 키도 존재 가능
            
            cf. **대체 키**: 기본 키가 아닌 후보 키 (기본 키 선정 후에 남은 후보 키..)
            
        4. **외래 키(FK)**: 다른 테이블의 기본 키를 참조하는 필드 → 테이블 간의 참조 관계 형성 시 사용

## 테이블의 관계

### 일대일 대응 관계

: 하나의 레코드가 다른 테이블의 레코드 하나에만 대응되는 경우

ex. 여권 테이블에 속한 엔티티 하나 → 승객 테이블에 속한 엔티티 하나에 대응 가능

### 일대다 대응 관계

: 하나의 레코드가 다른 테이블의 여러 레코드와 대응될 수 있는 경우

ex. 한 고객은 여러 주문 가능 / 각 주문은 한 명의 고객에만 속함

### 다대다 대응 관계

: 한 테이블의 여러 레코드가 다른 테이블의 여러 레코드와 대응되는 경우

ex. 하나의 사용자 계정이 여러 개의 그룹에 가입할 수 있는 경우.. 

~~⇒ 중간 테이블을 통한 다대다 대응관계~~

~~중간 테이블에 대한 일대다 대응이 두번 이루어진 것과 같음………..?~~

## 무결성 제약 조건

- 무결성: 일관되며 유효한 데이터의 상태
- 무결성 제약 조건: 데이터베이스에 저장된 데이터의 일관성과 유효성을 유지하기 위해 마땅히 지켜야하는 조건
    1. 도메인 제약 조건
        - 각 필드 데이터 : 원자값을 가져야 하고 / 지정된 필드 타입 준수 / 값의 범위, 기본값있으면 따라야 됨
        - 원자 값: 더 이상 쪼갤 수 없는 단일한 값
    2. 키 제약 조건 : 레코드를 고유하게 식별할 수 있는 키로 지정된 필드에 중복된 값이 존재하면 안됨 → 대체키
    3. 엔티티 무결성 제약 조건(=기본 키 제약 조건)
        - 기본 키로 지정한 필드 → 고유한 값이어야됨 + NULL이 되면 xx
    4. 참조 무결성 제약 조건(=외래 키 제약 조건)
        
        : 외래 키 → 참조하는 테이블의 기본 키와 같은 값을 갖거나 / NULL 값을 가져야
        
- 참조하는 테이블이 삭제/수정되는 경우
    
    ex. ‘학생 테이블’의 과목필드 → ‘과목 테이블’ 개설과목 필드 참조
    
    1. 연산 제한(restrict) : 주어진 수정,삭제 연산 자체를 거부
    2. 기본 값 설정(set default) : 참조하는 레코들르 미리 지정한 기본값으로 설정
        - 과목 테이블 ‘컴퓨터구조’ 삭제 → 학생 테이블의 해당 수강 과목 → 기본값으로 변경
    3. NULL 값 설정(set null) : 참조하는 레코드를 NULL로 설정
    4. 연쇄 변경(cascade) : 참조하는 레코드도 함께 수정되거나 삭제
        
        

# 3. SQL